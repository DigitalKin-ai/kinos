<!DOCTYPE html>
<html>
<head>
    <title>Parallagon Web</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://unpkg.com/vue@3"></script>
</head>
<body class="bg-gray-100">
    <div id="app" class="container mx-auto p-4">
        <header class="flex justify-between items-center mb-4">
            <h1 class="text-2xl font-bold">⚫ Parallagon</h1>
            <div class="space-x-2">
                <button @click="startAgents" class="bg-green-500 text-white px-4 py-2 rounded">Start</button>
                <button @click="stopAgents" class="bg-red-500 text-white px-4 py-2 rounded">Stop</button>
                <span :class="{'text-green-500': running, 'text-red-500': !running}">
                    ● {{running ? 'Running' : 'Stopped'}}
                </span>
            </div>
        </header>

        <div class="grid grid-cols-2 gap-4">
            <!-- Panneau Demande -->
            <div class="col-span-2 bg-white p-4 rounded shadow">
                <h2 class="text-xl font-bold mb-2">Demande</h2>
                <textarea v-model="content.demande" class="w-full h-64 p-2 border rounded"></textarea>
            </div>

            <!-- Panneaux Agents -->
            <div v-for="panel in ['specifications', 'management', 'production', 'evaluation']" 
                 :key="panel"
                 class="bg-white p-4 rounded shadow">
                <h2 class="text-xl font-bold mb-2 capitalize">{{panel}}</h2>
                <div class="h-64 overflow-auto">
                    <pre class="whitespace-pre-wrap">{{content[panel]}}</pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        const app = Vue.createApp({
            data() {
                return {
                    running: false,
                    content: {
                        demande: '',
                        specifications: '',
                        management: '',
                        production: '',
                        evaluation: ''
                    }
                }
            },
            methods: {
                async startAgents() {
                    await fetch('/api/start', {method: 'POST'});
                    this.running = true;
                },
                async stopAgents() {
                    await fetch('/api/stop', {method: 'POST'});
                    this.running = false;
                },
                async updateContent() {
                    const response = await fetch('/api/content');
                    this.content = await response.json();
                }
            },
            mounted() {
                this.updateContent();
                setInterval(this.updateContent, 1000);
            }
        }).mount('#app')
    </script>
</body>
</html>
